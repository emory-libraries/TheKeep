Installation & Upgrade instructions
===================================

Release 0.9 (?) - Min Items, part III
----------------------------------

Installation notes for this release:
* Need to install LAME. Can do so with: sudo apt-get install lame . This is for the WAV to MP3 conversion.

* Need to configure a celery broker server. More information on this type of server can be found at: 
  http://celeryq.org/docs/getting-started/broker-installation.html .

* General Celery/Django combination configuration notes: http://celeryq.org/docs/django-celery/getting-started/first-steps-with-django.html .

Release 0.8 (?) - Min Items, part II
-------------------------------
* The app now depends on the standard django ``sites`` module. This module
  stores some data in the relational database. To initialize it, sync the db::
    $ ./manage.py syncdb
  After restarting the web app, configure the default site by replacing the
  ``example.com`` domain with the domain of the live webapp.
* Django caching for lists based on Fedora objects requires defining a
  CACHE_BACKEND in localsettings.py (see localsettings-sample.py)
* The namespace for Digital Technical metadata was modified; any Audio objects
  loaded in the staging environment should be removed when this update is
  deployed.  This can be done in the django console as follows::
    python manage.py shell
    from digitalmasters.fedora import Repository
    from digitalmasters.audio.models import AudioObject
    repo = Repository()
    repo.get_objects_with_cmodel(AudioObject.AUDIO_CONTENT_MODEL)
    objs = repo.get_objects_with_cmodel(AudioObject.AUDIO_CONTENT_MODEL)
    for o in objs:
        repo.purge_object(o.pid)
* Support added for fetching new object pids from the pid manager. To
  configure it, add the following configuration options::
    PIDMAN_HOST = 'https://pid.emory.edu/' # the web root where we'll ask for pids
    PIDMAN_USER = 'exampleuser'
    PIDMAN_PASSWORD = 'examplepass'
    PIDMAN_DOMAIN = 'http://pid.emory.edu/domains/42/' # the full url of the domain we'll create pids in
  Note that commenting or removing any of these will raise an error if the
  ``DEV_ENV`` setting is ``False`` (as is normal for a production install).


Release 0.7 - Min Items, part I
-------------------------------
* The new batch-upload/ingest process may result in uploaded files
  that will need to be cleaned up.  There is a custom manage.py script
  to handle this which should be configured to run as a cron job.
  This script relies on the following django settings:
  INGEST_STAGING_TEMP_DIR and INGEST_STAGING_KEEP_AGE.  If run with
  verbosity 0, only errors will be reported, i.e.::
     ``python manage.py  ingest_cleanup -v 0``
  NOTE: this script will delete all files older than a specified age
  in the configured directory, so it should **not** be run as a
  privileged user.
* Now requires access to eXist Database for the purpose of generating
  Fedora collection objects based on EAD Finding Aid documents.  All EXISTDB
  settings in the localsettings example file should be configured for access
  to an eXist 1.4.x instance with Finding Aids content.  It is recommended to
  configure eXist access using guest access or a non-privileged account.
* Dependencies changed slightly. The current version depends on an updated
  version of eulcore, and we swapped our python-magic dependency for better
  Windows support. Remove the old dependencies and refresh them::
    $ . /home/euterpe/env/bin/activate
    $ pip uninstall eulcore python-magic
    $ pip install -r pip-dependencies
* After installation and configuration, ensure required numbering scheme
  objects are defined in fedora::
    $ ./manage.py syncrepo
* After defining numbering schemes, admins may want to load collections from
  Finding Aids:
    $ ./manage.py load_ead euterpe:marbl 10 59 265 494 539 558 572 579 612 \
        616 618 622 629 644 653 663 673 682 685 687 689 741 745 771 797 \
        800 807 832 840 845 853 855 856 869 890 892 923 926 927 932 937 \
        960 966 968 981 1000 1002 1025 1032 1054 1056 1061
    $ ./manage.py load_ead euterpe:university-archives 8 11 26 60 113 1002


Release 0.6
-------------
* Requires Fedora 3.4 or greater with LDAP login configured.
* Requires Fedora XACML policies (bundled with other local policies in
  https://svn.library.emory.edu/svn/fedora/repository-policies/
* After django application and Fedora are both configured, run
  syncrepo to load Fedora fixtures and control objects::
  ``python manage.py syncrepo``

