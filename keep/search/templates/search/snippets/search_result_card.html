{% extends 'eultheme/snippets/card_with_preview.html' %}
{% load audio_extras %} {% load search_tags %}
{# public-facing search result card; currently audio-only #}

{% block result-header %}
    <h3><a href="{% url 'audio:view' r.pid %}">{{ r.title }}</a>
     {% if 'info:fedora' in r.collection_id %}  {# convert to pid if id is in URI format #}
        {% url 'collection:view' r.collection_id|slice:'12:' as collection_url %}
    {% else %}
        {% url 'collection:view' r.collection_id as collection_url %}
    {% endif %}
    <h4><a class="text-muted" href="{{ collection_url }}">{{ r.collection_source_id }}: {{ r.collection_label }}</a></h4>
    {# TODO: use r.collection_id to link to collection page once we have one #}

{% endblock %}

{% block result-info %}
    {% if r.score %}
    {# display numerical score in debug mode #}
    {% if debug %}<p>{{ r.score }}</p>{% endif %}
    <div class="progress">
        <div class="progress-bar" role="progressbar" aria-valuenow="{{ r.score }}" aria-valuemin="0" aria-valuemax="1.5" style="width:{% widthratio r.score 1 90 %}%"> </div>

    </div>
    {% endif %}

{% endblock %}

{% block result-content %}
    <div class="row">
        {% if r.date_issued %}
        <div class="col-xs-5">
            <h4>Issued</h4>
            {{ r.date_issued|natural_date }}
        </div>
        {% endif %}
        {% if r.date_created %}
        <div class="col-xs-5">
            <h4>Created</h4>
            {{ r.date_created|natural_date }}
        </div>
        {% endif %}
    </div>

    {# display part note if any (side A/B, etc) #}
    {% if r.part %}<p>{{ r.part }}</p>{% endif %}

    {% if r.duration %}<p>{{ r.duration|natural_seconds }}</p>{% endif %}

    {# display ARK NOID if possible; fall-back to pid display #}
    <div class="input-group">
      <span class="input-group-addon">ID</span>
      <input type="text" readonly="readonly" class="item-id form-control" value=" {% firstof r.ark_uri|ark_noid r.pid %}">
    </div>

    {% if perms.audio.change_audio %}
    <div class="pull-right">
        <a href="{% url 'audio:edit' r.pid %}"><span class="glyphicon glyphicon-edit"></span></a>
    </div>
    {% endif %}

{% endblock %}

{% block result-preview %}
    <h3>{{ r.title }}</a></h3>
    <p class="centered">
        <a class="btn btn-primary" href="#" >Open Resource</a>
    </p>
{% endblock %}

