{% extends 'search/snippets/list-item.html' %}
{% load humanize %}
{% load audio_extras %}

{% block item_title %}
<p><a href="{% url audio:edit obj.pid %}">{{ obj.title|default:'(no title)' }}</a>
  {% if obj.part %} ({{ obj.part }}){% endif %}
  {% if obj.collection_id %} 
    (part of <a href="{# {% url collection:edit obj.collection_id|slice:'12:' %} #}">{{ obj.collection_label }}</a>)
  {% endif %} </p>
{% endblock %}

{% block item_info %}  {# TODO: use horizontal list for this #}
  <p>
  {% if obj.duration %}{{ obj.duration|seconds_duration }} | {% endif %}
  {% if obj.has_original %}
     <a href="{% url audio:download-audio obj.pid %}">original audio</a> 
  | 
  {% endif %}
  {% if obj.has_access_copy %}
    {% if obj.access_copy_mimetype == "audio/mp4" %}
      {% url audio:download-compressed-audio obj.pid 'm4a' as access_url %}
    {% else %} {# default to mp3 otherwise #}
      {% url audio:download-compressed-audio obj.pid 'mp3' as access_url %}
    {% endif %}

    <a href="{{ access_url }}">access copy</a>
    {% if obj.access_copy_size %}({{ obj.access_copy_size|filesizeformat }}){% endif %}
    {# TODO: mimetype icon ? #}
  {% if obj.rights %} | {% endif %}
  {% endif %}
  {{ obj.rights|join:', ' }}</p>
{% endblock %}
