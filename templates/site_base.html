{% extends "genlib_templates/bluegray_site_base.xhtml" %}

{% block page-title %}The Keep {% block page-subtitle %}: Home{% endblock %}{% endblock %}

{% block style %}
    {{ block.super }}
    {% comment %}Place Local changes, modifications and overrisdes in your local.css file.{% endcomment %}
   <link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}/style/local.css" />
   <link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}/style/smoothness/jquery-ui-1.8.19.custom.css" />
{% endblock %}

{% block scripts %}
    {{ block.super }}
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/jquery-ui-1.8.19.custom.min.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/jquery.tooltips.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/local.js"></script>
    <script type ="text/javascript">
      $(document).ready(function () {
        $("#keyword-search input[name=keyword]").categorycomplete({
          source: "{% url search:suggest %}",
          minLength: 0,
          });
        {# remove this when old search is removed from sidebar #}
        {% include "collection/snippets/collection_suggest_js.html" %}
      });
    </script>

    {% include 'common/snippets/beta_warning.html' %}

{% if not DEBUG %} {# google analytics tracking code #}
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31534030-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
{% endif %}
</script>

{% endblock %}

{% block site-name %}
<img id="keep-logo" src="{{ MEDIA_URL }}/images/keep.png" />
The Keep

{% endblock %}
{% block site-slogan %}{# ??? #}{% endblock %}

{% load eulcore_tags %}

{% block navbar-items %}
    <li><a href="{% url collection:browse %}">Collections</a></li>
    {% if perms.common.arrangement_allowed %}
         <li><a href="{% url collection:simple_browse %}">Simple Collections</a></li>
    {% endif  %}
{% endblock %}

{% block content-header %}
 {% if user.is_authenticated %}
   <div id="logged-in">
     <p>Welcome, {% firstof user.first_name user.username %}.
        <a href="{% url accounts:logout %}">Logout</a></p>
   </div>
 {% endif %}

 {# restrict search to logged-in users #}
 {% if user.is_authenticated and keyword_search %}
  <div id="keyword-search" class="search">
    <h2>Search</h2>
    <form method="get" action="{% url search:keyword %}">
      {{ keyword_search.keyword }}
      <input class="form-submit" type="submit" value="Go" />
      </form>
      <a class="tip" title="{{ keyword_search.keyword.help_text }}" >i</a>
</div>
  {% endif %}

 {{ block.super }}
{% endblock %}

{% block sidebar-left %}
 {% if user.is_authenticated %}{# for now restrict search to logged-in users #}
   <div class="note">
     <h2>Note</h2> 

     <p>The old item and collection search are being replaced by the
     new, combined search to the right.</p>
     <p>The old search will be available for a transition period but
     will eventually be removed.  If you find any functionality in the
     old search that is not available in the new one, please report
     it.</p>
   </div>

   <a id="use-old-search">Access the old search.</a>

   <div id="old-search" style="display:none">
  {% if item_search %}
    {% include 'audio/snippets/search_form.html' %}
  {% endif %}
  {% if collection_search %}
    {% include 'collection/snippets/search_form.html' %}
  {% endif %}
  <div class="help">
    <a onMouseOver="jQuery('#search-help').show()"
       onMouseOut="jQuery('#search-help').hide()">?</a>
    <div id="search-help" class="search-tips">{{ collection_search.search_tips }}</div>
   </div>
   </div>
   <script type="text/javascript">
     $(document).ready(function () { {# show/hide advanced-search block #}
       $("#use-old-search").click(function(){
           $("#old-search").toggle();
         });
       });
   </script>


 {% endif %}
{% endblock %}

{% block message %}
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|safe }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    {% if server_error %}
        <ul class='errorlist'>
          <li class='error'>{{ server_error }}</li>
        </ul>
    {% endif %}
{% endblock %}

{% block content-outer-bottom %}
  {% if SW_VERSION %}
    <div class="sw-version dev-note">v{{ SW_VERSION }}</div>
  {% endif %}
{% endblock %}
